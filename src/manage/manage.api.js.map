{"version":3,"file":"manage.api.js","sourceRoot":"","sources":["manage.api.ts"],"names":[],"mappings":"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","sourcesContent":["\r\n(function() {\r\n    var mngApi = $2sxc._manage;\r\n\r\n    /**\r\n     * Get a html tag of the current sxc instance\r\n     * @param {any} sxci\r\n     * @return {jquery} - resulting html\r\n     */\r\n    $2sxc._manage.getTag = function(sxci) {\r\n        return $(\"div[data-cb-id='\" + sxci.cbid + \"']\")[0];\r\n    };\r\n\r\n\r\n\r\n    /**\r\n     * get the edit-context object (a json object) of the current tag/sxc-instance\r\n     * @param {any} htmlTag\r\n     * @return {any} edit-context object\r\n     */\r\n    $2sxc._manage.getEditContextOfTag = function getEditContextOfTag(htmlTag) {\r\n        var attr = htmlTag.getAttribute(\"data-edit-context\");\r\n        return JSON.parse(attr || \"\");\r\n    };\r\n\r\n\r\n\r\n    /**\r\n     * get edit-context info of an sxc-object\r\n     * @param {any} sxc\r\n     * @return {any} edit context info\r\n     */\r\n    $2sxc._manage.getEditContext = function getEditContext(sxc) {\r\n        return $2sxc._manage.getEditContextOfTag(mngApi.getTag(sxc));\r\n    };\r\n\r\n\r\n    /**\r\n     * builds a config object used in the toolbar system\r\n     * @param {any} editContext \r\n     * @returns {any} object containing various properties for this current sxc-instance\r\n     */\r\n    $2sxc._manage.buildInstanceConfig = function(editContext) {\r\n        var ce = editContext.Environment,\r\n            cg = editContext.ContentGroup,\r\n            cb = editContext.ContentBlock;\r\n        return {\r\n            portalId: ce.WebsiteId,\r\n            tabId: ce.PageId,\r\n            moduleId: ce.InstanceId,\r\n            version: ce.SxcVersion,\r\n\r\n            contentGroupId: cg.Guid,\r\n            cbIsEntity: cb.IsEntity,\r\n            cbId: cb.Id,\r\n            appPath: cg.AppUrl,\r\n            isList: cg.IsList\r\n        };\r\n    };\r\n\r\n\r\n    $2sxc._manage.getUserOfEditContext = function getUserOfEditContext(editContext) {\r\n        return {\r\n            canDesign: editContext.User.CanDesign,\r\n            canDevelop: editContext.User.CanDesign\r\n        };\r\n    };\r\n\r\n\r\n\r\n    /**\r\n     * create a config-object for the quick-dialog, with all settings which the quick-dialog will need\r\n     * @param {any} editContext\r\n     * @returns {any} \r\n     */\r\n\r\n    $2sxc._manage.buildQuickDialogConfig = function buildQuickDialogConfig(editContext) {\r\n        return {\r\n            appId: editContext.ContentGroup.AppId,\r\n            isContent: editContext.ContentGroup.IsContent,\r\n            hasContent: editContext.ContentGroup.HasContent,\r\n            isList: editContext.ContentGroup.IsList,\r\n            templateId: editContext.ContentGroup.TemplateId,\r\n            contentTypeId: editContext.ContentGroup.ContentTypeName,\r\n            templateChooserVisible: editContext.ContentBlock.ShowTemplatePicker, // todo: maybe move to content-goup\r\n            user: $2sxc._manage.getUserOfEditContext(editContext),\r\n            supportsAjax: editContext.ContentGroup.SupportsAjax\r\n        };\r\n    };\r\n\r\n    /**\r\n        * get all parameters needed by NG dialogs from an sxc\r\n        * @param {any} sxc\r\n        * @param {any} [editContext]\r\n        * @return {any} special object containing the ng-dialog parameters\r\n        */\r\n    $2sxc._manage.buildNgDialogParams = function buildNgDialogParams(sxc, editContext) {\r\n        if (!editContext) editContext = mngApi.getEditContext(sxc);\r\n        return {\r\n            zoneId: editContext.ContentGroup.ZoneId,\r\n            appId: editContext.ContentGroup.AppId,\r\n            tid: editContext.Environment.PageId,\r\n            mid: editContext.Environment.InstanceId,\r\n            cbid: sxc.cbid,\r\n            lang: editContext.Language.Current,\r\n            langpri: editContext.Language.Primary,\r\n            langs: JSON.stringify(editContext.Language.All),\r\n            portalroot: editContext.Environment.WebsiteUrl,\r\n            websiteroot: editContext.Environment.SxcRootUrl,\r\n            partOfPage: editContext.ContentBlock.PartOfPage,\r\n            //versioningRequirements: editContext.ContentBlock.VersioningRequirements,\r\n            publishing: editContext.ContentBlock.VersioningRequirements,\r\n\r\n            // todo: probably move the user into the dashboard info\r\n            user: $2sxc._manage.getUserOfEditContext(editContext),\r\n            approot: editContext.ContentGroup.AppUrl || null // this is the only value which doesn't have a slash by default.  note that the app-root doesn't exist when opening \"manage-app\"\r\n        };\r\n    };\r\n})();"]}