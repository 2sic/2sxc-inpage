{"version":3,"file":"$quickE.clipboard.js","sourceRoot":"","sources":["$quickE.clipboard.ts"],"names":[],"mappings":"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","sourcesContent":["// add a clipboard to the quick edit\r\n$(function () {\r\n\r\n    // perform copy and paste commands - needs the clipboard\r\n    $quickE.copyPasteInPage = function (cbAction, list, index, type) {\r\n        var newClip = $quickE.clipboard.createSpecs(type, list, index);\r\n\r\n        // action!\r\n        switch (cbAction) {\r\n            case \"select\":\r\n                $quickE.clipboard.mark(newClip);\r\n                break;\r\n            case \"paste\":\r\n                var from = $quickE.clipboard.data.index, to = newClip.index;\r\n                // check that we only move block-to-block or module to module\r\n                if ($quickE.clipboard.data.type !== newClip.type)\r\n                    return alert(\"can't move module-to-block; move only works from module-to-module or block-to-block\");\r\n\r\n                if (isNaN(from) || isNaN(to) || from === to) // || from + 1 === to) // this moves it to the same spot, so ignore\r\n                    return $quickE.clipboard.clear(); // don't do anything\r\n\r\n                // cb-numbering is a bit different, because the selector is at the bottom\r\n                // only there we should also skip on +1;\r\n                if(newClip.type === $quickE.selectors.cb.id && from + 1 === to)\r\n                    return $quickE.clipboard.clear(); // don't do anything\r\n\r\n                if (type === $quickE.selectors.cb.id) {\r\n                    $2sxc(list).manage._getCbManipulator().move(newClip.parent, newClip.field, from, to);\r\n                } else {\r\n                    $quickE.cmds.mod.move($quickE.clipboard.data, newClip, from, to);\r\n                }\r\n                $quickE.clipboard.clear();\r\n                break;\r\n            default:\r\n        }\r\n        return null;\r\n    };\r\n\r\n    // clipboard object - remembers what module (or content-block) was previously copied / needs to be pasted\r\n    $quickE.clipboard = {\r\n        data: {},\r\n        mark: function (newData) {\r\n            if (newData) {\r\n                // if it was already selected with the same thing, then release it\r\n                if ($quickE.clipboard.data && $quickE.clipboard.data.item === newData.item)\r\n                    return $quickE.clipboard.clear();\r\n                $quickE.clipboard.data = newData;\r\n            }\r\n            $(\".\" + $quickE.selectors.selected).removeClass($quickE.selectors.selected); // clear previous markings\r\n            var cb = $($quickE.clipboard.data.item);\r\n            cb.addClass($quickE.selectors.selected);\r\n            if (cb.prev().is(\"iframe\"))\r\n                cb.prev().addClass($quickE.selectors.selected);\r\n            $quickE.setSecondaryActionsState(true);\r\n            $quickE.selected.toggle(cb, $quickE.clipboard.data.type);\r\n        },\r\n        clear: function () {\r\n            $(\".\" + $quickE.selectors.selected).removeClass($quickE.selectors.selected);\r\n            $quickE.clipboard.data = null;\r\n            $quickE.setSecondaryActionsState(false);\r\n            $quickE.selected.toggle(false);\r\n        },\r\n\r\n        createSpecs: function (type, list, index) {\r\n            var listItems = list.find($quickE.selectors[type].selector);\r\n            if (index >= listItems.length) index = listItems.length - 1; // sometimes the index is 1 larger than the length, then select last\r\n            var currentItem = listItems[index];\r\n            var editContext = JSON.parse(list.attr($quickE.selectors.cb.context) || null) || { parent: \"dnn\", field: list.id };\r\n            return { parent: editContext.parent, field: editContext.field, list: list, item: currentItem, index: index, type: type };\r\n        }\r\n    };\r\n\r\n\r\n    $quickE.setSecondaryActionsState = function (state) {\r\n        var btns = $(\"a.sc-content-block-menu-btn\");\r\n        btns = btns.filter(\".icon-sxc-paste\");\r\n        btns.toggleClass(\"sc-unavailable\", !state);\r\n    };\r\n\r\n\r\n    $quickE.selected.toggle = function (target) {\r\n        if (!target)\r\n            return $quickE.selected.hide();\r\n\r\n        var coords = $quickE.getCoordinates(target);\r\n        coords.yh = coords.y + 20;\r\n        $quickE.positionAndAlign($quickE.selected, coords);\r\n        $quickE.selected.target = target;\r\n    };\r\n\r\n    // bind clipboard actions \r\n    $(\"a\", $quickE.selected).click(function () {\r\n        var action = $(this).data(\"action\");\r\n        var clip = $quickE.clipboard.data;\r\n        switch (action) {\r\n            case \"delete\":\r\n                return $quickE.cmds[clip.type].delete(clip);\r\n            case \"sendToPane\":\r\n                return $quickE.cmds.mod.sendToPane(clip);\r\n        }\r\n    });\r\n\r\n});"]}