{"version":3,"file":"contentBlock.manipulate.js","sourceRoot":"","sources":["contentBlock.manipulate.ts"],"names":[],"mappings":"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","sourcesContent":["// contains commands to create/move/delete a contentBlock in a page\r\n\r\n$2sxc._contentBlock.manipulator = function (sxc) {\r\n    return {\r\n        create: create,\r\n        move: move,\r\n        delete: remove\r\n    };\r\n\r\n    function create(parentId, fieldName, index, appName, container, newGuid) {\r\n        // the wrapper, into which this will be placed and the list of pre-existing blocks\r\n        var listTag = container;\r\n        if (listTag.length === 0) return alert('can\\'t add content-block as we couldn\\'t find the list');\r\n        var cblockList = listTag.find('div.sc-content-block');\r\n        if (index > cblockList.length) index = cblockList.length; // make sure index is never greater than the amount of items\r\n\r\n        var params = {\r\n            parentId: parentId,\r\n            field: fieldName,\r\n            sortOrder: index,\r\n            app: appName,\r\n            guid: newGuid,\r\n        };\r\n        return sxc.webApi.get({ url: 'view/module/generatecontentblock', params: params })\r\n            .then(function (result) {\r\n                var newTag = $(result); // prepare tag for inserting\r\n\r\n                // should I add it to a specific position...\r\n                if (cblockList.length > 0 && index > 0)\r\n                    $(cblockList[cblockList.length > index - 1 ? index - 1 : cblockList.length - 1])\r\n                        .after(newTag);\r\n                else //...or just at the beginning?\r\n                    listTag.prepend(newTag);\r\n\r\n                var sxcNew = $2sxc(newTag);\r\n                $2sxc._toolbarManager.buildToolbars(newTag);\r\n            });\r\n    }\r\n\r\n    function move(parentId, field, indexFrom, indexTo) {\r\n        var params = {\r\n            parentId: parentId,\r\n            field: field,\r\n            indexFrom: indexFrom,\r\n            indexTo: indexTo,\r\n        };\r\n\r\n        // todo: need sxc!\r\n        return sxc.webApi.get({ url: 'view/module/moveiteminlist', params: params })\r\n            .then(function () {\r\n                console.log(\"done moving!\");\r\n                window.location.reload();\r\n            });\r\n    }\r\n\r\n    // delete a content-block inside a list of content-blocks\r\n    function remove(parentId, field, index) {\r\n        if (!confirm($2sxc.translate('QuickInsertMenu.ConfirmDelete'))) return null;\r\n        var params = {\r\n            parentId: parentId,\r\n            field: field,\r\n            index: index,\r\n        };\r\n        return sxc.webApi.get({ url: 'view/module/RemoveItemInList', params: params })\r\n            .then(function () {\r\n                console.log('done deleting!');\r\n                window.location.reload();\r\n            });\r\n    }\r\n};"]}